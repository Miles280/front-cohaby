<form
  [formGroup]="searchForm"
  (ngSubmit)="onSearch()"
  class="mb-6 flex flex-wrap gap-4 bg-white p-6 rounded-lg shadow"
>
  <input
    type="text"
    placeholder="Ville"
    formControlName="city"
    class="input px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
  />
  <input
    type="number"
    placeholder="Prix max"
    formControlName="maxPrice"
    class="input px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
  />
  <input
    type="number"
    placeholder="Capacité max"
    formControlName="maxCapacity"
    class="input px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
  />

  <!-- Equipments multi-select -->
  <div class="relative">
    <button
      type="button"
      (click)="toggleEquipments()"
      class="btn bg-primary text-light rounded-md px-4 py-2"
    >
      Équipements
    </button>
    <div
      *ngIf="showEquipments"
      class="absolute bg-white border border-gray-300 p-4 rounded shadow-md z-10 max-h-60 overflow-auto w-56 mt-2"
    >
      <label
        *ngFor="let eq of availableEquipments; trackBy: trackById"
        class="flex items-center gap-2 mb-1 cursor-pointer"
      >
        <input
          type="checkbox"
          [value]="eq['@id']"
          (change)="onEquipmentChange($event, eq['@id'])"
          [checked]="selectedEquipments.includes(eq['@id']!)"
          class="form-checkbox"
        />
        {{ eq.name }}
      </label>
    </div>

    <!-- Tags -->
    <div class="flex flex-wrap gap-2 mt-2">
      <span
        *ngFor="let selected of selectedEquipments; trackBy: trackById"
        class="bg-gray-200 px-3 py-1 rounded-full text-sm flex items-center gap-1"
      >
        {{ getEquipmentName(selected) }}
        <button
          (click)="removeEquipment(selected)"
          type="button"
          class="text-red-500 hover:text-red-700 font-bold"
        >
          ✕
        </button>
      </span>
    </div>
  </div>

  <!-- Services multi-select (nouveau) -->
  <div class="relative ml-4">
    <button
      type="button"
      (click)="toggleServices()"
      class="btn bg-primary text-light rounded-md px-4 py-2"
    >
      Services
    </button>
    <div
      *ngIf="showServices"
      class="absolute bg-white border border-gray-300 p-4 rounded shadow-md z-10 max-h-60 overflow-auto w-56 mt-2"
    >
      <label
        *ngFor="let srv of availableServices; trackBy: trackById"
        class="flex items-center gap-2 mb-1 cursor-pointer"
      >
        <input
          type="checkbox"
          [value]="srv['@id']"
          (change)="onServiceChange($event, srv['@id'])"
          [checked]="selectedServices.includes(srv['@id']!)"
          class="form-checkbox"
        />
        {{ srv.name }}
      </label>
    </div>

    <!-- Tags -->
    <div class="flex flex-wrap gap-2 mt-2">
      <span
        *ngFor="let selected of selectedServices; trackBy: trackById"
        class="bg-gray-200 px-3 py-1 rounded-full text-sm flex items-center gap-1"
      >
        {{ getServiceName(selected) }}
        <button
          (click)="removeService(selected)"
          type="button"
          class="text-red-500 hover:text-red-700 font-bold"
        >
          ✕
        </button>
      </span>
    </div>
  </div>

  <button
    type="submit"
    class="btn bg-secondary text-dark rounded-md px-6 py-2 font-semibold hover:bg-accent transition"
  >
    Rechercher
  </button>
</form>
